<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Devjyoti Chakrabarti">

<title>Behavioural Economics - Day 5: All About Heuristics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body>

<div id="quarto-search-results"></div>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#recap" id="toc-recap" class="nav-link active" data-scroll-target="#recap">Recap</a></li>
  <li><a href="#todays-agenda" id="toc-todays-agenda" class="nav-link" data-scroll-target="#todays-agenda">Today’s Agenda</a></li>
  <li><a href="#a-slight-detour" id="toc-a-slight-detour" class="nav-link" data-scroll-target="#a-slight-detour">A Slight Detour</a></li>
  <li><a href="#nudge-theory" id="toc-nudge-theory" class="nav-link" data-scroll-target="#nudge-theory">Nudge Theory</a></li>
  <li><a href="#automatic-system-system-1" id="toc-automatic-system-system-1" class="nav-link" data-scroll-target="#automatic-system-system-1">Automatic System (System 1)</a></li>
  <li><a href="#reflective-system-system-2" id="toc-reflective-system-system-2" class="nav-link" data-scroll-target="#reflective-system-system-2">Reflective System (System 2)</a></li>
  <li><a href="#more-examples-of-both-systems" id="toc-more-examples-of-both-systems" class="nav-link" data-scroll-target="#more-examples-of-both-systems">More examples of both systems</a></li>
  <li><a href="#back-to-the-detour-cognitive-reflection-test2" id="toc-back-to-the-detour-cognitive-reflection-test2" class="nav-link" data-scroll-target="#back-to-the-detour-cognitive-reflection-test2">Back to the Detour (Cognitive Reflection Test)</a></li>
  <li><a href="#what-is-the-nudge-in-nudge-theory" id="toc-what-is-the-nudge-in-nudge-theory" class="nav-link" data-scroll-target="#what-is-the-nudge-in-nudge-theory">What is the Nudge in Nudge Theory</a></li>
  <li><a href="#examples-of-nudges" id="toc-examples-of-nudges" class="nav-link" data-scroll-target="#examples-of-nudges">Examples of Nudges</a></li>
  <li><a href="#social-nudges" id="toc-social-nudges" class="nav-link" data-scroll-target="#social-nudges">Social Nudges</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  <li><a href="#prospect-theory6" id="toc-prospect-theory6" class="nav-link" data-scroll-target="#prospect-theory6">Prospect Theory</a></li>
  <li><a href="#certainty-effects" id="toc-certainty-effects" class="nav-link" data-scroll-target="#certainty-effects">Certainty Effects</a></li>
  <li><a href="#loss-aversion" id="toc-loss-aversion" class="nav-link" data-scroll-target="#loss-aversion">Loss Aversion</a></li>
  <li><a href="#reference-dependence" id="toc-reference-dependence" class="nav-link" data-scroll-target="#reference-dependence">Reference Dependence</a></li>
  <li><a href="#risk-orientation" id="toc-risk-orientation" class="nav-link" data-scroll-target="#risk-orientation">Risk Orientation</a></li>
  <li><a href="#conclusion-1" id="toc-conclusion-1" class="nav-link" data-scroll-target="#conclusion-1">Conclusion</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="all_about_heuristics.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Day 5: All About Heuristics</h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Devjyoti Chakrabarti </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            University of Oxford
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
  
    
  </div>
  


</header>


<section id="recap" class="level3">
<h3 class="anchored" data-anchor-id="recap">Recap</h3>
<ul>
<li><p>People don’t have unlimited cognitive abilities and limited attention to make decisions (bounded rationality)</p></li>
<li><p>To make the decision making process simpler, people rely on heuristics/mental shortcuts</p></li>
<li><p>Although convenient, these shortcuts can be the source of many major errors and biases</p></li>
</ul>
</section>
<hr>
<section id="todays-agenda" class="level3">
<h3 class="anchored" data-anchor-id="todays-agenda">Today’s Agenda</h3>
<ul>
<li><p>Delve deeper into these heuristics</p></li>
<li><p>Understand two important behavioural economics theories:</p>
<ol type="1">
<li><p>Nudge Theory</p></li>
<li><p>Prospect Theory</p></li>
</ol></li>
</ul>
</section>
<hr>
<section id="a-slight-detour" class="level3">
<h3 class="anchored" data-anchor-id="a-slight-detour">A Slight Detour</h3>
<ul>
<li>Answer the questions given to you with the first answer that comes to your mind. You have 1 minute to answer all the questions.</li>
</ul>
</section>
<hr>
<section id="nudge-theory" class="level3">
<h3 class="anchored" data-anchor-id="nudge-theory">Nudge Theory</h3>
<ul>
<li><p>Highly recommended reading: Thinking, Fast and Slow by Daniel Kahneman</p></li>
<li><p>We want to start thinking about how to solve these puzzles of human thought and make sense of these seeming contradictions</p></li>
<li><p>The workings of the brain consists of two components or systems</p>
<ul>
<li><p>System 1 is the fast and intuitive</p></li>
<li><p>System 2 is the slow and reflective</p></li>
</ul></li>
</ul>
</section>
<hr>
<div style="text-align:center">
<table class="caption-top table">
<colgroup>
<col style="width: 41%">
<col style="width: 43%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Automatic System (System 1)</th>
<th style="text-align: center;">Reflective System (System 2)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><p>Uncontrolled</p>
<p>Effortless</p>
<p>Associative</p>
<p>Fast</p>
<p>Unconscious</p>
<p>Skilled<br>
</p></td>
<td style="text-align: center;"><p>Controlled</p>
<p>Effortful</p>
<p>Deductive</p>
<p>Slow</p>
<p>Self-aware</p>
<p>Rule-following<br>
</p></td>
</tr>
</tbody>
</table>
</div>
<hr>
<section id="automatic-system-system-1" class="level3">
<h3 class="anchored" data-anchor-id="automatic-system-system-1">Automatic System (System 1)</h3>
<ul>
<li><p>“Action without thought”. This system is responsible for rapid and instinctive decisions</p></li>
<li><p>Examples: reaction when a ball is thrown at you unexpectedly</p></li>
<li><p>Fun fact: This system is associated with the oldest parts of the brain which we share with lizards and puppies<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p></li>
</ul>
</section>
<hr>
<section id="reflective-system-system-2" class="level3">
<h3 class="anchored" data-anchor-id="reflective-system-system-2">Reflective System (System 2)</h3>
<ul>
<li><p>This is the more deliberate and self-conscious system.</p></li>
<li><p>Example: whats 239 * 196</p></li>
<li><p>The Automatic System can be thought of as your gut feeling while the reflective system is your conscious thought.</p></li>
</ul>
</section>
<hr>
<section id="more-examples-of-both-systems" class="level3">
<h3 class="anchored" data-anchor-id="more-examples-of-both-systems">More examples of both systems</h3>
<ol type="1">
<li><p>When told the temperature in Celsius, most people have an Automatic System reaction while interpreting temperature in Fahrenheit requires use of the Reflective System</p></li>
<li><p>People speak their native languages using their Automatic Systems and tend to struggle to speak another language using their Reflective Systems.</p></li>
</ol>
</section>
<hr>
<section id="back-to-the-detour-cognitive-reflection-test2" class="level3">
<h3 class="anchored" data-anchor-id="back-to-the-detour-cognitive-reflection-test2">Back to the Detour (Cognitive Reflection Test)<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></h3>
<ol type="1">
<li><p>A bat and ball cost $1.10 in total. The bat costs $1.00 more than the ball. How much does the ball cost?</p></li>
<li><p>If it takes 5 machines 5 minutes to make 5 widgets, how long would it take 100 machines to make 100 widgets?</p></li>
<li><p>Mary’s mother had four children. The youngest three are named: Spring, Summer, and Autumn. What is the eldest child’s name?<br>
</p></li>
</ol>
</section>
<hr>
<div>
<ul>
<li><p>The most common answers to these questions is 10 cents, 100 minutes and Winter. While the correct answers are 5 cents, 5 minutes and Mary respectively.</p></li>
<li><p>Students from a lot of top universities were asked some of these questions (MIT, Harvard, Princeton) and the wrong answers tended to be popular.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p></li>
</ul>
</div>
<hr>
<section id="what-is-the-nudge-in-nudge-theory" class="level3" style="font-size: 0.875em">
<h3 class="anchored" data-anchor-id="what-is-the-nudge-in-nudge-theory">What is the Nudge in Nudge Theory</h3>
<ul>
<li><p>So far we have seen that because people can’t think deeply about each choice they face so they tend to accept questions as they are framed instead of trying to consider answers under alternative formulations.</p></li>
<li><p>What this suggests to us is that people are “nudge-able”. Their choices, even in life’s most important decisions, are influenced in ways that would not be anticipated in a standard economic framework.</p></li>
<li><p>Nudge: “a way to manipulate people’s choices to lead them to make specific decisions… An essential aspect of nudges is that they are not coercive”<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p></li>
</ul>
</section>
<hr>
<section id="examples-of-nudges" class="level3 nonincremental" style="font-size: 0.775em">
<h3 class="nonincremental anchored" data-anchor-id="examples-of-nudges">Examples of Nudges</h3>
<ul>
<li><p>Nudges through provision of information</p>
<ul>
<li><p>Calorie counts on menus</p></li>
<li><p>Packaging of food products</p></li>
</ul></li>
<li><p>Changes to environment</p>
<ul>
<li><p>Having fewer lifts in buildings</p></li>
<li><p>Changing default options on phones</p></li>
</ul></li>
<li><p>Financial (dis)incentives to take particular courses of actions</p>
<ul>
<li><p>Higher taxes on cigarettes and subsidies for electric vehicles</p></li>
<li><p>Positive gamification and mobile apps: Qapital, fitness apps<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p></li>
</ul></li>
</ul>
</section>
<hr>
<section id="social-nudges" class="level3" style="font-size: 0.775em">
<h3 class="anchored" data-anchor-id="social-nudges">Social Nudges</h3>
<ul>
<li><p>Social influence is one of the most effective ways to nudge</p></li>
<li><p>Social influence comes through two categories:</p>
<ul>
<li><p>Information</p></li>
<li><p>Peer pressure</p></li>
</ul></li>
<li><p>Some examples of the power of social nudges are:</p>
<ul>
<li><p>The academic effort of college students is influenced by their peers</p></li>
<li><p>Charity donations/Confirm shaming</p></li>
<li><p>American judicial system</p></li>
</ul></li>
</ul>
</section>
<hr>
<section id="conclusion" class="level3">
<h3 class="anchored" data-anchor-id="conclusion">Conclusion</h3>
<ul>
<li><p>People can be nudged to make certain choices and decisions</p></li>
<li><p>Nudges are inherently non-coercive</p></li>
<li><p>Nudges make us act reflexively instead of reflectively</p></li>
<li><p>People’s desire to conform make social nudges very powerful</p></li>
</ul>
</section>
<hr>
<section id="prospect-theory6" class="level3">
<h3 class="anchored" data-anchor-id="prospect-theory6">Prospect Theory<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a></h3>
<ul>
<li><p>Emerging out of a series of empirical results, it is a critique of the expected utility theory for analyzing choices under uncertainty.</p></li>
<li><p>Prospect theory focuses on gains and losses (in place of expected values) and decision weights (replacing probabilities)</p></li>
</ul>
</section>
<hr>
<section id="certainty-effects" class="level3">
<h3 class="anchored" data-anchor-id="certainty-effects">Certainty Effects</h3>
<ul>
<li><p>In expected utility theory, the utilities of outcomes are weighted by their probabilities.</p></li>
<li><p>Problem 1: Choose between</p>
<table class="caption-top table">
<colgroup>
<col style="width: 31%">
<col style="width: 30%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">A</th>
<th style="text-align: center;"><strong>B</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><p>2500 with prob. 0.33</p>
<p>2400 with prob 0.66</p>
<p>0 with prob. 0.01</p></td>
<td style="text-align: center;">2400 with certainty</td>
</tr>
</tbody>
</table></li>
</ul>
</section>
<hr>
<div style="font-size: 0.775em">
<ul>
<li><p>Problem 2: Choose between</p>
<table class="caption-top table">
<colgroup>
<col style="width: 31%">
<col style="width: 31%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">C</th>
<th style="text-align: center;">D</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><p>2500 with prob. 0.33</p>
<p>0 with prob. 0.67</p></td>
<td style="text-align: center;"><p>2400 with prob. 0.34</p>
<p>0 with prob. 0.66</p></td>
</tr>
</tbody>
</table></li>
<li><p>For Problem 1, 82% choose option B and 18% choose option A (<span class="math inline">\(N=72\)</span>). For Problem 2, 83% choose option C and the remaining option D (<span class="math inline">\(N=72\)</span>).</p></li>
<li><p>But for <span class="math inline">\(u(0) = 0\)</span></p>
<p><span class="math display">\[
\begin{align*}
   u(2400) &amp;&gt; 0.33 u(2500) + 0.66 u(2400) \text{ and} \\
   0.34 u(2400) &amp;&gt; 0.33 u(2500)
\end{align*}
\]</span></p></li>
<li><p>Certainty effect: people overweight outcomes that are considered certain, relative to outcomes which are merely probable. Certainty increases the aversiveness of losses as well as the desirability of gains.</p></li>
</ul>
</div>
<hr>
<section id="loss-aversion" class="level3">
<h3 class="anchored" data-anchor-id="loss-aversion">Loss Aversion</h3>
</section>
<hr>
<section id="reference-dependence" class="level3">
<h3 class="anchored" data-anchor-id="reference-dependence">Reference Dependence</h3>
</section>
<hr>
<section id="risk-orientation" class="level3">
<h3 class="anchored" data-anchor-id="risk-orientation">Risk Orientation</h3>
</section>
<hr>
<section id="conclusion-1" class="level3">
<h3 class="anchored" data-anchor-id="conclusion-1">Conclusion</h3>
<ul>
<li><p>Prospect theory is a critique of expected utility theory</p></li>
<li></li>
</ul>
</section>




<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Philip Lieberman, Human Language and Our Reptilian Brain (Cambridge, MA: Harvard University Press, 2002); Joseph LeDoux, “The Emotional Brain, Fear, and the Amygdala,” Cellular and Molecular Neurobiology 23, no. 4–5 (2003): 727–38.<br>
<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Thaler, R. H., &amp; Sunstein, C. R. (2021). Nudge: The Final Edition. Penguin Publishing.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Shane Frederick, “Cognitive Reflection and Decision Making,” Journal of Economic Perspectives 19, no. 4 (2005): 25–42.<br>
<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p><a href="https://news.uchicago.edu/explainer/what-is-behavioral-economics" class="uri">https://news.uchicago.edu/explainer/what-is-behavioral-economics</a><a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>Cotton V, Patel MS. Gamification Use and Design in Popular Health and Fitness Mobile Applications. Am J Health Promot. 2019 Mar;33(3):448-451. doi: 10.1177/0890117118790394. Epub 2018 Jul 26. PMID: 30049225; PMCID: PMC6348030.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>Kahneman, D., &amp; Tversky, A. (1979). Prospect Theory: An Analysis of Decision under Risk.&nbsp;<em>Econometrica</em>,&nbsp;<em>47</em>(2), 263–291. https://doi.org/10.2307/1914185<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>